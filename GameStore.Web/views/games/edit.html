<!-- views/games/edit.html -->
<div class="mb-4">
  <button class="btn btn-outline-secondary btn-sm" ng-click="vm.cancel()">
    <i class="bi bi-arrow-left me-1"></i>Back to Games
  </button>
</div>

<!-- Loading -->
<div ng-if="vm.isLoading" class="text-center py-5">
  <div class="spinner-border text-primary" role="status"></div>
  <p class="mt-2 text-muted">Loading game…</p>
</div>

<!-- Content -->
<div ng-if="!vm.isLoading" class="row justify-content-center">
  <div class="col-lg-6">
    <div class="card shadow border-0">

      <div class="card-header bg-primary text-white">
        <h5 class="mb-0"><i class="bi bi-pencil me-2"></i>Edit Game</h5>
      </div>

      <div class="card-body">

        <!-- Error alert -->
        <div ng-if="vm.errorMsg" class="alert alert-danger alert-dismissible" role="alert">
          <i class="bi bi-exclamation-triangle me-2"></i>{{ vm.errorMsg }}
          <button type="button" class="btn-close" ng-click="vm.errorMsg = null"></button>
        </div>

        <form name="editForm" novalidate ng-submit="vm.submit(editForm)" ng-if="vm.game">

          <!-- Name -->
          <div class="mb-3">
            <label for="name" class="form-label fw-semibold">
              Name <span class="text-danger">*</span>
            </label>
            <input
              id="name"
              type="text"
              class="form-control"
              ng-class="{'is-invalid': editForm.$submitted && editForm.name.$invalid}"
              name="name"
              ng-model="vm.game.name"
              maxlength="50"
              required
              placeholder="Enter game name"
            />
            <div class="invalid-feedback">Name is required and must be 50 characters or fewer.</div>
          </div>

          <!-- Genre -->
          <div class="mb-3">
            <label for="genreId" class="form-label fw-semibold">
              Genre <span class="text-danger">*</span>
            </label>
            <select
              id="genreId"
              class="form-select"
              ng-class="{'is-invalid': editForm.$submitted && editForm.genreId.$invalid}"
              name="genreId"
              ng-model="vm.game.genreId"
              ng-options="g.id as g.name for g in vm.genres"
              required
            >
              <option value="">— Select a genre —</option>
            </select>
            <div class="invalid-feedback">Please select a genre.</div>
          </div>

          <!-- Price -->
          <div class="mb-3">
            <label for="price" class="form-label fw-semibold">
              Price ($) <span class="text-danger">*</span>
            </label>
            <div class="input-group">
              <span class="input-group-text">$</span>
              <input
                id="price"
                type="number"
                class="form-control"
                ng-class="{'is-invalid': editForm.$submitted && editForm.price.$invalid}"
                name="price"
                ng-model="vm.game.price"
                min="1"
                max="100"
                step="0.01"
                required
                placeholder="0.00"
              />
              <div class="invalid-feedback">Price must be between $1 and $100.</div>
            </div>
          </div>

          <!-- Release Date -->
          <div class="mb-4">
            <label for="releaseDate" class="form-label fw-semibold">
              Release Date <span class="text-danger">*</span>
            </label>
            <input
              id="releaseDate"
              type="date"
              class="form-control"
              ng-class="{'is-invalid': editForm.$submitted && editForm.releaseDate.$invalid}"
              name="releaseDate"
              ng-model="vm.game.releaseDate"
              required
            />
            <div class="invalid-feedback">Release date is required.</div>
          </div>

          <!-- Actions -->
          <div class="d-flex gap-2">
            <button
              type="submit"
              class="btn btn-primary"
              ng-disabled="vm.isSaving"
            >
              <span
                ng-if="vm.isSaving"
                class="spinner-border spinner-border-sm me-1"
                role="status"
              ></span>
              <i ng-if="!vm.isSaving" class="bi bi-save me-1"></i>
              {{ vm.isSaving ? 'Saving…' : 'Save Changes' }}
            </button>
            <button type="button" class="btn btn-outline-secondary" ng-click="vm.cancel()">
              Cancel
            </button>
          </div>

        </form>
      </div><!-- /card-body -->
    </div><!-- /card -->
  </div>
</div>
